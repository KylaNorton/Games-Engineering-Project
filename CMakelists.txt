cmake_minimum_required(VERSION 3.21)
project(Games-Engineering-Project)
# Require modern C++
set(CMAKE_CXX_STANDARD 14)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

#### Setup Directories ####
#Main output directory
SET(OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/bin/")
# Ouput all DLLs from all libs into main build folder
SET(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${OUTPUT_DIRECTORY})

#### Add External Dependencies ####
add_subdirectory("lib/SFML")
set(SFML_INCS "lib/SFML/include")
link_directories("${CMAKE_BINARY_DIR}/lib/SFML/lib")


#### Games-Engineering-Project ####
add_executable(Games-Engineering-Project 
levelSettings.cpp levelSettings.hpp
gameSettings.cpp gameSettings.hpp
map.cpp map.hpp
scores.cpp scores.hpp
account.cpp account.hpp
settings.cpp settings.hpp
game.cpp game.hpp
level.cpp level.hpp
menu.hpp menu.cpp
playerSave.hpp playerSave.cpp
main.cpp
)

add_custom_command(TARGET Games-Engineering-Project POST_BUILD
  COMMAND ${CMAKE_COMMAND} -E make_directory "$<TARGET_FILE_DIR:Games-Engineering-Project>/res"
  COMMAND ${CMAKE_COMMAND} -E copy_directory
          "${PROJECT_SOURCE_DIR}/res"
          "$<TARGET_FILE_DIR:Games-Engineering-Project>/res"
)

if (WIN32)
  add_custom_command(TARGET Games-Engineering-Project POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E copy_if_different
            $<TARGET_RUNTIME_DLLS:Games-Engineering-Project> $<TARGET_FILE_DIR:Games-Engineering-Project>
    COMMAND_EXPAND_LISTS
  )
endif()

if (WIN32)
  add_custom_command(TARGET Games-Engineering-Project POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E copy_if_different
            $<TARGET_RUNTIME_DLLS:Games-Engineering-Project> $<TARGET_FILE_DIR:Games-Engineering-Project>
    COMMAND_EXPAND_LISTS
  )
endif()

target_include_directories(Games-Engineering-Project PRIVATE ${SFML_INCS})
target_link_libraries(Games-Engineering-Project
    sfml-graphics
    sfml-window
    sfml-system
)

set_target_properties(Games-Engineering-Project 
    PROPERTIES VS_DEBUGGER_WORKING_DIRECTORY
    ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/$(Configuration)
)